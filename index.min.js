!function(){function u(e){var t={top:0,left:0},l=e&&e.ownerDocument,n=l.documentElement;return void 0!==e.getBoundingClientRect&&(t=e.getBoundingClientRect()),e=null!=(l=e=l)&&l===l.window?e:9===e.nodeType&&e.defaultView,{top:t.top+e.pageYOffset-n.clientTop,left:t.left+e.pageXOffset-n.clientLeft}}function y(e,t){for(t=t.toUpperCase();e.parentNode&&e.tagName.toUpperCase()!==t;)e=e.parentNode;return e.tagName.toUpperCase()===t?e:void 0}var b,g=$('<tr class="table-dnd-placeholder"><td style="border:2px dashed grey;"><div></div></td><tr>')[0],m=$('<td class="table-dnd-placeholder" style="border:2px dashed grey;"><div></div></td>')[0],w=$('<table class="table-dnd-container" cellSpacing="0" cellPadding="0" style="z-index:10;position:absolute; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;"><tbody class="table-dnd-tbody"></tbody></table>')[0];function e(){$("[table-dnd-horz]>tbody>tr:first-child>td, [table-dnd-vert]>tbody>tr").forEach(e=>{t(e)})}function t(c){let e=y(c,"table"),f=e.hasAttribute("table-dnd-horz")?1:0;Number.parseInt(window.getComputedStyle(e).getPropertyValue("border-spacing").split(" ")[0]);let h=(0==f?e:e.children[0]).children[0].children;h=Array.prototype.map.call(h,e=>e),$(c).mousedown(n=>{if(n.ctrlKey){n.stopPropagation();let e=function(e,t){for(;e.parentNode&&-1===t.indexOf(e);)e=e.parentNode;return e}(n.target,h);0==f&&(e=e.children[0]);var o=Number.parseInt(window.getComputedStyle(e).getPropertyValue("padding"));Number.parseInt(window.getComputedStyle(e).getPropertyValue("border-width"));let t=0==f?e.parentNode:e;var d=0==f?t.rowIndex:t.cellIndex,{top:r,left:a}=u(t),{width:i,height:p}=t.getBoundingClientRect(),s=(y(t,"table"),0==f?g:m);let l=$("div",s)[0];l.style.width=i-2*o-4,l.style.height=p-2*o-4,w.style.top=r+o,w.style.left=a+o,w.style.width=i,t.replaceWith(s),$("tbody",w)[0].appendChild(t),w.setAttribute("cellpadding",o),$("body")[0].appendChild(w),b={mouse:{startX:n.clientX,startY:n.clientY},el:{startX:a,startY:r,w:i,h:p},all:h.filter(e=>e!==c),ph:s,index:d,type:f}}})}let n;"undifined"==typeof $?console.error("jq-min is not defined, cannot find $ function"):document.addEventListener("DOMContentLoaded",()=>{$("body").mousemove(e=>{if(b){e.stopPropagation();var i=b.el.startX+(e.clientX-b.mouse.startX),p=b.el.startY+(e.clientY-b.mouse.startY);w.style.top=p,w.style.left=i;let a=u(b.ph)["left"];b.all.forEach((e,t)=>{var l,{top:n,left:o}=u(e),d=e.offsetWidth,r=e.offsetHeight;0===b.type?(o<=i&&i<=o+d||i+b.el.w>=o&&i+b.el.w<=o+d)&&(l=u(b.ph)["top"],l<n&&p+b.el.h>n+r/2?b.ph.before(e):n<l&&p<n+r/2&&b.ph.after(e)):(n<=p&&p<=n+r||p+b.el.h>=n&&p+b.el.h<=n+r)&&(a<o&&i+b.el.w>o+d/2?(e.replaceWith(b.ph),b.ph.before(e)):a>o&&i<o+d/2&&b.ph.after(e))})}}).mouseup(t=>{if(b){t.stopPropagation();var l=0===b.type?g:m,t=0===b.type?l.rowIndex:l.cellIndex;let e=w.children[0].children[0];e.remove(),l.replaceWith(e),w.remove(),n&&n(e,b.index,t),b=void 0}}),e()}),window.tableDnd={init:t,initAll:e,setCallback:function(e){n=e}}}();
